<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Defining a diffusion · BridgeSDEInference.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">BridgeSDEInference.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../overview/">Workflow</a></li><li class="is-active"><a class="tocitem" href>Defining a diffusion</a><ul class="internal"><li><a class="tocitem" href="#Imports-1"><span>Imports</span></a></li><li><a class="tocitem" href="#Definition-of-the-target-process-1"><span>Definition of the target process</span></a></li><li><a class="tocitem" href="#Definition-of-the-auxiliary-process-1"><span>Definition of the auxiliary process</span></a></li></ul></li><li><a class="tocitem" href="../generate_data/">Data generation</a></li><li><a class="tocitem" href="../diffusion_setup/">Diffusion Setup</a></li><li><a class="tocitem" href="../mcmc_setup/">MCMC Setup</a></li><li><a class="tocitem" href="../run/">Running the sampler</a></li><li><a class="tocitem" href="../query/">Querying the results</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/fitzhugh_nagumo/">FitzHugh-Nagumo model</a></li><li><a class="tocitem" href="../../examples/jansen_rit/">Jansen-Rit model</a></li><li><a class="tocitem" href="../../examples/lorenz63/">Lorenz63 system</a></li><li><a class="tocitem" href="../../examples/lorenz96/">Lorenz96 system</a></li><li><a class="tocitem" href="../../examples/prokaryote/">Prokaryotic autoregulatory gene network</a></li><li><a class="tocitem" href="../../examples/sine/">Sine diffusion</a></li></ul></li><li><a class="tocitem" href="../../vis/visualisation/">Visualisation tools</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../../extras/generic_mcmc/">Generic MCMC</a></li><li><a class="tocitem" href="../../extras/first_passage_times/">First passage times</a></li><li><a class="tocitem" href="../../extras/blocking/">Blocking</a></li></ul></li><li><span class="tocitem">Adaptations</span><ul><li><a class="tocitem" href="../../adaptations/adaptive_proposals/">Adaptive proposals</a></li><li><a class="tocitem" href="../../adaptations/fusion/">Fusion</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Defining a diffusion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Defining a diffusion</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mmider/BridgeSDEInference.jl/blob/master/docs/src/man/model_definition.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Definition-of-a-diffusion-process-1"><a class="docs-heading-anchor" href="#Definition-of-a-diffusion-process-1">Definition of a diffusion process</a><a class="docs-heading-anchor-permalink" href="#Definition-of-a-diffusion-process-1" title="Permalink"></a></h1><p>To define a diffusion model suitable for inference with <code>BridgeSDEInference.jl</code> one must define two processes:</p><ul><li>the <code>target</code> diffusion</li><li>and the <code>auxiliary</code> diffusion</li></ul><h2 id="Imports-1"><a class="docs-heading-anchor" href="#Imports-1">Imports</a><a class="docs-heading-anchor-permalink" href="#Imports-1" title="Permalink"></a></h2><p>The diffusion definitions will extend some of the functionality of the existing functions from <code>Bridge.jl</code>, so the following imports are necessary:</p><pre><code class="language-julia">using Bridge
import Bridge: b, σ, B, β, a, constdiff</code></pre><h2 id="Definition-of-the-target-process-1"><a class="docs-heading-anchor" href="#Definition-of-the-target-process-1">Definition of the target process</a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-target-process-1" title="Permalink"></a></h2><p>The target process needs to be a struct inheriting from <code>ContinuousTimeProcess{ℝ{d,T}}</code> (where <code>d</code> is a dimension of the diffusion) with the first type parameter <code>{T}</code> defining the data-type of the parameters. The members of the struct must define the diffusion process and are usually limited to a list of parameters. An example of a valid definition of a <code>10</code> dimensional diffusion with two parameters <span>$\alpha$</span> and <span>$\beta$</span> would be</p><pre><code class="language-julia">struct TargetDiffusion{T} &lt;: ContinuousTimeProcess{ℝ{10,T}}
    α::T
    β::T
    TargetDiffusion(α::T, β::T) where T = new{T}(α, β)
end</code></pre><p>Then, one must specify the dynamics of the diffusion by specifying the behaviour of the drift and volatility functions <code>b</code> and <code>σ</code> (defined in <code>Bridge.jl</code>) for <code>TargetDiffusion</code>:</p><pre><code class="language-julia">b(t, x, P::TargetDiffusion) = foo(t, x, P.α, P.β)
σ(t, x, P::TargetDiffusion) = bar(t, x, P.α, P.β)</code></pre><p>where <code>foo</code> and <code>bar</code> are some user-defined functions. Finally, three auxiliary functions must be defined:</p><pre><code class="language-julia">constdiff(::TargetDiffusion) = false</code></pre><p>indicating whether <code>σ(t, x, P::TargetDiffusion)</code> is independent from the values of <code>x</code> and <code>t</code>,</p><pre><code class="language-julia">clone(P::TargetDiffusion, θ) = TargetDiffusion(θ...)</code></pre><p>which returns a new copy of the process with new set of parameters, and finally</p><pre><code class="language-julia">params(P::TargetDiffusion) = [P.α, P.β]</code></pre><p>which returns an array with all parameter values. Optionally, functions <code>nonhypo</code>, <code>hypo_a_inv</code>, <code>num_non_hypo</code> and <code>phi</code> can be defined to make it possible to perform conjugate updates of the parameters (see ... for more details on conjugate updates [TODO add])</p><h2 id="Definition-of-the-auxiliary-process-1"><a class="docs-heading-anchor" href="#Definition-of-the-auxiliary-process-1">Definition of the auxiliary process</a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-auxiliary-process-1" title="Permalink"></a></h2><p>The auxiliary diffusion, similarly, needs to be a struct inheriting from <code>ContinuousTimeProcess{ℝ{d,T}}</code> with the first type parameter <code>{T}</code> defining the data-type of the parameters. It is often necessary for the auxiliary diffusion to have to have access to the information regarding the starting and ending time of the interval on which it is defined. Additionally, the starting and end-point of the target process are also sometimes used (if available). An example of a definition of the auxiliary diffusion is:</p><pre><code class="language-julia">struct AuxiliaryDiffusion{R,S1,S2}
    α::R
    β::R
    t::Float64    # starting time of the interval
    u::S1         # starting position of the target process
    T::Float64    # end-time of the interval
    v::S2         # final position of the target process
    AuxiliaryDiffusion(α::R, β::R, t, u::S1, T, v::S2) = new{R,S1,S2}(α, β, t, u, T, v)
end</code></pre><p>It is now necessary to specify the dynamics of the process. Unlike in the case of the <code>Target</code>, specifying the volatility coefficient is not necessary and it is sufficient to only provide a diffusion coefficient (<code>a:=σσ&#39;</code>). The package supports only linear diffusions as auxiliary processes and thus function <code>b</code> should be defined as:</p><pre><code class="language-julia">b(t, x, P::AuxiliaryDiffusion) = B(t, P) * x + β(t, P)</code></pre><p>where <code>B</code> and <code>β</code> need to be overwritten as follows:</p><pre><code class="language-julia">B(t, P::AuxiliaryDiffusion) = foo2(t, P)
β(t, P::AuxiliaryDiffusion) = foo3(t, P)</code></pre><p>where the user-defined functions <code>foo2</code> and <code>foo3</code> should return a <code>d</code> by <code>d</code> matrix and a length-<code>d</code> vector respectively. One needs to define the diffusion coefficient</p><pre><code class="language-julia">a(t, P::AuxiliaryDiffusion) = bar2(t, P)</code></pre><p>As previously, the <code>clone</code> constructor, <code>params</code> and also a convenience function returning the names of the paramters:</p><pre><code class="language-julia">clone(P::AuxiliaryDiffusion, θ) = AuxiliaryDiffusion(θ..., P.t, P.u, P.T, P.v)
params(P::AuxiliaryDiffusion) = (P.α, P.β)
param_names(P::AuxiliaryDiffusion) = (:α, :β)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Workflow</a><a class="docs-footer-nextpage" href="../generate_data/">Data generation »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 13 January 2020 13:01">Monday 13 January 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
