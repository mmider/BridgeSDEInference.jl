<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diffusion Setup · BridgeSDEInference.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">BridgeSDEInference.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../overview/">Workflow</a></li><li><a class="tocitem" href="../model_definition/">Defining a diffusion</a></li><li><a class="tocitem" href="../generate_data/">Data generation</a></li><li class="is-active"><a class="tocitem" href>Diffusion Setup</a><ul class="internal"><li><a class="tocitem" href="#Defining-the-processes-1"><span>Defining the processes</span></a></li><li><a class="tocitem" href="#Observations-1"><span>Observations</span></a></li><li><a class="tocitem" href="#Imputation-grid-1"><span>Imputation grid</span></a></li><li><a class="tocitem" href="#Prior-over-the-starting-point-1"><span>Prior over the starting point</span></a></li><li><a class="tocitem" href="#Auxiliary-parameters-1"><span>Auxiliary parameters</span></a></li><li><a class="tocitem" href="#Initialisation-of-internal-containers-1"><span>Initialisation of internal containers</span></a></li></ul></li><li><a class="tocitem" href="../mcmc_setup/">MCMC Setup</a></li><li><a class="tocitem" href="../run/">Running the sampler</a></li><li><a class="tocitem" href="../query/">Querying the results</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/fitzhugh_nagumo/">FitzHugh-Nagumo model</a></li><li><a class="tocitem" href="../../examples/jansen_rit/">Jansen-Rit model</a></li><li><a class="tocitem" href="../../examples/lorenz63/">Lorenz63 system</a></li><li><a class="tocitem" href="../../examples/lorenz96/">Lorenz96 system</a></li><li><a class="tocitem" href="../../examples/prokaryote/">Prokaryotic autoregulatory gene network</a></li><li><a class="tocitem" href="../../examples/sine/">Sine diffusion</a></li></ul></li><li><a class="tocitem" href="../../vis/visualisation/">Visualisation tools</a></li><li><span class="tocitem">Extras</span><ul><li><a class="tocitem" href="../../extras/generic_mcmc/">Generic MCMC</a></li><li><a class="tocitem" href="../../extras/first_passage_times/">First passage times</a></li><li><a class="tocitem" href="../../extras/blocking/">Blocking</a></li></ul></li><li><span class="tocitem">Adaptations</span><ul><li><a class="tocitem" href="../../adaptations/adaptive_proposals/">Adaptive proposals</a></li><li><a class="tocitem" href="../../adaptations/fusion/">Fusion</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Diffusion Setup</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Diffusion Setup</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mmider/BridgeSDEInference.jl/blob/master/docs/src/man/diffusion_setup.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Defining-the-observational-scheme-1"><a class="docs-heading-anchor" href="#Defining-the-observational-scheme-1">Defining the observational scheme</a><a class="docs-heading-anchor-permalink" href="#Defining-the-observational-scheme-1" title="Permalink"></a></h1><p>To run the MCMC sampler we need to pass a <code>setup</code> object that defines the statistical model. In this section we will show how to define a diffusion model using a pre-defined <code>DiffusionSetup</code>. Nonetheless, be aware that the logic of the MCMC sampler is independent from the model specification, so it is possible to use the <code>mcmc</code> routines from this package and run them on other statistical models. For more information about these types of extensions see <a href="../../extras/generic_mcmc/#Generic-MCMC-1">Generic MCMC</a>.</p><h2 id="Defining-the-processes-1"><a class="docs-heading-anchor" href="#Defining-the-processes-1">Defining the processes</a><a class="docs-heading-anchor-permalink" href="#Defining-the-processes-1" title="Permalink"></a></h2><p>To define the <code>DiffusionSetup</code> we need to decide on the <code>Target</code> diffusion, an <code>Auxiliary</code> diffusion and the observation scheme. For instance, suppose that there are three observations:</p><pre><code class="language-julia">obs = [...]
obs_times = [1.0, 2.0, 3.0]</code></pre><p>Then we define the <code>target</code> diffusion globally and the <code>auxiliary</code> diffusion separately on each interval</p><pre><code class="language-julia">P_target = TargetDiffusion(parameters)
P_auxiliary = [AuxiliaryDiffusion(parameters, o, t) for (o,t) in zip(obs, obs_times)]</code></pre><p>To define the setup for partially observed diffusion it is enough to write:</p><pre><code class="language-julia">model_setup = DiffusionSetup(P_target, P_auxiliary, PartObs()) # for first passage times use FPT()</code></pre><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.DiffusionSetup" href="#BridgeSDEInference.DiffusionSetup"><code>BridgeSDEInference.DiffusionSetup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DiffusionSetup{ObsScheme} &lt;: ModelSetup</code></pre><p>Setup choices relevant to the path augmentation step to be passed to <code>mcmc</code> function from <code>mcmc.jl</code>.</p><p><strong>Example:</strong></p><pre><code class="language-none">         DiffusionSetup(P, P̃)
         DiffusionSetup(P, P̃, fptOrPartObs)</code></pre><p>where P is the target process and P̃ is the linear approximation and possibly a vector of Booleans whether the observations are first passage times.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc/setup.jl#L43-L57">source</a></section></article><h2 id="Observations-1"><a class="docs-heading-anchor" href="#Observations-1">Observations</a><a class="docs-heading-anchor-permalink" href="#Observations-1" title="Permalink"></a></h2><p>To set the observations, in addition to passing the observations and observation times it is necessary to pass the observational operators as well as covariance of the noise. Additionally, one can pass additional information about the <a href="../../extras/first_passage_times/#FPT_header-1">first passage time scheme</a>.</p><pre><code class="language-julia">L = ...
Σ = ...
set_observations!(model_setup, [L for _ in obs], [Σ for _ in obs], obs, obs_time)</code></pre><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>set_observations!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Imputation-grid-1"><a class="docs-heading-anchor" href="#Imputation-grid-1">Imputation grid</a><a class="docs-heading-anchor-permalink" href="#Imputation-grid-1" title="Permalink"></a></h2><p>There are two objects that define the imputation grid. The time step <code>dt</code> and the time transformation that transforms a regular time-grid with equidistantly distributed imputation points. The second defaults to a usual transformation employed in papers on the guided proposals. [TO DO add also space-time transformation from the original paper for the bridges]. It is enough to call</p><pre><code class="language-julia">dt = ...
set_imputation_grid!(model_setup, dt)</code></pre><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.set_imputation_grid!" href="#BridgeSDEInference.set_imputation_grid!"><code>BridgeSDEInference.set_imputation_grid!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_imputation_grid!(setup::DiffusionSetup, dt,
                     time_transf=(t₀,T) -&gt; ((x) -&gt;  t₀ + (x-t₀) * (2-(x-t₀)/(T-t₀))))</code></pre><p>Define the imputation grid in <code>setup</code>. <code>dt</code> defines the granulatrity of the imputation grid and <code>time_transf</code> defines a time transformation to use for transforming equidistant grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc/setup.jl#L123-L130">source</a></section></article><h2 id="Prior-over-the-starting-point-1"><a class="docs-heading-anchor" href="#Prior-over-the-starting-point-1">Prior over the starting point</a><a class="docs-heading-anchor-permalink" href="#Prior-over-the-starting-point-1" title="Permalink"></a></h2><p>There are two types of priors for the starting point, either a <code>delta hit</code> at some specified value, corresponding to a known starting point and a Gaussian prior</p><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.KnownStartingPt" href="#BridgeSDEInference.KnownStartingPt"><code>BridgeSDEInference.KnownStartingPt</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KnownStartingPt{T} &lt;: StartingPtPrior</code></pre><p>Indicates that the starting point is known and stores its value in <code>y</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc_extras/starting_pt.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.GsnStartingPt" href="#BridgeSDEInference.GsnStartingPt"><code>BridgeSDEInference.GsnStartingPt</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">GsnStartingPt{T,S} &lt;: StartingPtPrior</code></pre><p>Indicates that the starting point is equipped with a Gaussian prior with mean <code>μ</code> and covariance matrix <code>Σ</code>. It also stores the most recently sampled white noise <code>z</code> used to compute the starting point and a precision matrix <code>Λ</code>:=<code>Σ</code>⁻¹. <code>μ₀</code> and <code>Σ₀</code> are the mean and covariance of the white noise</p><pre><code class="language-none">GsnStartingPt(μ::T, Σ::S)</code></pre><p>Base constructor. It initialises the mean <code>μ</code> and covariance <code>Σ</code> parameters and <code>Λ</code> is set according to <code>Λ</code>:=<code>Σ</code>⁻¹</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc_extras/starting_pt.jl#L25-L37">source</a></section></article><p>For instance, to set a known starting point it is enough to call:</p><pre><code class="language-julia">set_x0_prior!(model_setup, KnownStartingPt(x0))</code></pre><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.set_x0_prior!" href="#BridgeSDEInference.set_x0_prior!"><code>BridgeSDEInference.set_x0_prior!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_x0_prior!(setup::DiffusionSetup, x0_prior, x0_guess=nothing)</code></pre><p>Store the priors over the starting point into the object <code>setup</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc/setup.jl#L145-L149">source</a></section></article><h2 id="Auxiliary-parameters-1"><a class="docs-heading-anchor" href="#Auxiliary-parameters-1">Auxiliary parameters</a><a class="docs-heading-anchor-permalink" href="#Auxiliary-parameters-1" title="Permalink"></a></h2><p>There are two auxiliary parameters that can be set by the user. The first one is a thinning factor for saving the paths that are sampled by the MCMC sampler. The second specifies an adaptation scheme for tuning Guided proposals [TODO change the latter].</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>set_auxiliary!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Initialisation-of-internal-containers-1"><a class="docs-heading-anchor" href="#Initialisation-of-internal-containers-1">Initialisation of internal containers</a><a class="docs-heading-anchor-permalink" href="#Initialisation-of-internal-containers-1" title="Permalink"></a></h2><p>Once all the setting functions above have been run (with the only exception <code>set_auxiliary!</code> being optional), i.e.</p><pre><code class="language-julia">setup = DiffusionSetup(...)
set_observations!(setup, ...)
set_imputation_grid(setup, ...)
set_x0_prior!(setup, ...)</code></pre><p>then the following function should be run</p><article class="docstring"><header><a class="docstring-binding" id="BridgeSDEInference.initialise!" href="#BridgeSDEInference.initialise!"><code>BridgeSDEInference.initialise!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">initialise(::Type{K}, setup::DiffusionSetup; verbose=false,
                    change_pt=NoChangePt())</code></pre><p>Initialise the internal containers of <code>setup</code>. Check if all the necessary data has been passed to <code>setup</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/a3e4d42ab043f97134a0f9f42cf2dfd07bbc461d/src/mcmc/setup.jl#L353-L359">source</a></section></article><p>Once run, the model setup is complete.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../generate_data/">« Data generation</a><a class="docs-footer-nextpage" href="../mcmc_setup/">MCMC Setup »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 15 January 2020 10:22">Wednesday 15 January 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
