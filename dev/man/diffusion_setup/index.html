<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diffusion Setup · BridgeSDEInference.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>BridgeSDEInference.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorial</span><ul><li><a class="toctext" href="../overview/">Workflow</a></li><li><a class="toctext" href="../model_definition/">Defining a diffusion</a></li><li><a class="toctext" href="../generate_data/">Data generation</a></li><li class="current"><a class="toctext" href>Diffusion Setup</a><ul class="internal"><li><a class="toctext" href="#Defining-the-processes-1">Defining the processes</a></li><li><a class="toctext" href="#Observations-1">Observations</a></li><li><a class="toctext" href="#Imputation-grid-1">Imputation grid</a></li><li><a class="toctext" href="#Prior-over-the-starting-point-1">Prior over the starting point</a></li><li><a class="toctext" href="#Auxiliary-parameters-1">Auxiliary parameters</a></li><li><a class="toctext" href="#Initialisation-of-internal-containers-1">Initialisation of internal containers</a></li></ul></li><li><a class="toctext" href="../mcmc_setup/">MCMC Setup</a></li><li><a class="toctext" href="../run/">Running the sampler</a></li><li><a class="toctext" href="../query/">Querying the results</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/fitzhugh_nagumo/">FitzHugh-Nagumo model</a></li><li><a class="toctext" href="../../examples/jansen_rit/">Jansen-Rit model</a></li><li><a class="toctext" href="../../examples/lorenz63/">Lorenz63 system</a></li><li><a class="toctext" href="../../examples/lorenz96/">Lorenz96 system</a></li><li><a class="toctext" href="../../examples/prokaryote/">Prokaryotic autoregulatory gene network</a></li><li><a class="toctext" href="../../examples/sine/">Sine diffusion</a></li></ul></li><li><a class="toctext" href="../../vis/visualisation/">Visualisation tools</a></li><li><span class="toctext">Extras</span><ul><li><a class="toctext" href="../../extras/generic_mcmc/">Generic MCMC</a></li><li><a class="toctext" href="../../extras/first_passage_times/">First passage times</a></li><li><a class="toctext" href="../../extras/blocking/">Blocking</a></li></ul></li><li><span class="toctext">Adaptations</span><ul><li><a class="toctext" href="../../adaptations/adaptive_proposals/">Adaptive proposals</a></li><li><a class="toctext" href="../../adaptations/fusion/">Fusion</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorial</li><li><a href>Diffusion Setup</a></li></ul><a class="edit-page" href="https://github.com/mmider/BridgeSDEInference.jl/blob/master/docs/src/man/diffusion_setup.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Diffusion Setup</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Defining-the-observational-scheme-1" href="#Defining-the-observational-scheme-1">Defining the observational scheme</a></h1><p>To run the MCMC sampler we need to pass a <code>setup</code> object that defines the statistical model. In this section we will show how to define a diffusion model using a pre-defined <code>DiffusionSetup</code>. Nonetheless, be aware that the logic of the MCMC sampler is independent from the model specification, so it is possible to use the <code>mcmc</code> routines from this package routine to run it on other statistical models. For more information about these types of extensions see <a href="../../extras/generic_mcmc/#Generic-MCMC-1">Generic MCMC</a>.</p><h2><a class="nav-anchor" id="Defining-the-processes-1" href="#Defining-the-processes-1">Defining the processes</a></h2><p>To define the <code>DiffusionSetup</code> we need to decide on the <code>Target</code> diffusion, an <code>Auxiliary</code> diffusion and the observation scheme. For instance, suppose that there are three observations:</p><pre><code class="language-julia">obs = [...]
obs_times = [1.0, 2.0, 3.0]</code></pre><p>Then we define the <code>target</code> diffusion globally and the <code>auxiliary</code> diffusion separately on each interval</p><pre><code class="language-julia">P_target = TargetDiffusion(parameters)
P_auxiliary = [AuxiliaryDiffusion(parameters, o, t) for (o,t) in zip(obs, obs_times)]</code></pre><p>To define the setup for partially observed diffusion it is enough to write:</p><pre><code class="language-julia">model_setup = DiffusionSetup(P_target, P_auxiliary, PartObs()) # for first passage times use FPT()</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.DiffusionSetup" href="#BridgeSDEInference.DiffusionSetup"><code>BridgeSDEInference.DiffusionSetup</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">MCMCSetup</code></pre><p>Groups together all objects that need to be passed to <code>mcmc</code> function from <code>mcmc.jl</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc/setup.jl#L35-L40">source</a></section><h2><a class="nav-anchor" id="Observations-1" href="#Observations-1">Observations</a></h2><p>To set the observations, apart from passing the observations and observation times it is necessary to pass the observational operators and as well as covariance of the noise. Additionally, one can pass additional information about the <a href="../../extras/first_passage_times/#FPT_header-1">first passage time scheme</a>.</p><pre><code class="language-julia">L = ...
Σ = ...
set_observations!(model_setup, [L for _ in obs], [Σ for _ in obs], obs, obs_time)</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.set_observations!" href="#BridgeSDEInference.set_observations!"><code>BridgeSDEInference.set_observations!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">set_observations!(setup::DiffusionSetup, Ls, Σs, obs, obs_times,
                  fpt=fill(nothing, length(obs)-1))</code></pre><p>Store observations to <code>setup</code>. The observations follow the scheme <code>V=LX+η</code>, where V are the observations in <code>obs</code>, observed at times given in <code>obs_times</code>, <code>L</code> are the observation operators given in <code>Ls</code>, <code>X</code> is the unobserved, underlying diffusion and <code>η</code> is a Gaussian noise with mean <code>0</code> and covariance <code>Σ</code> with the last stored in <code>Σs</code>. <code>fpt</code> provides additional information in case the nature of observations has to do with first-passage times</p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc/setup.jl#L77-L87">source</a></section><h2><a class="nav-anchor" id="Imputation-grid-1" href="#Imputation-grid-1">Imputation grid</a></h2><p>There are two objects that define the imputation grid. The time step <code>dt</code> and the time transformation that transforms a regular time-grid with equidistantly distributed imputation points. The second defaults to a usual transformation employed in papers on the guided proposals. [TO DO add also space-time transformation from the original paper for the bridges]. It is enough to call</p><pre><code class="language-julia">dt = ...
set_imputation_grid!(model_setup, dt)</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.set_imputation_grid!" href="#BridgeSDEInference.set_imputation_grid!"><code>BridgeSDEInference.set_imputation_grid!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">set_imputation_grid!(setup::DiffusionSetup, dt,
                     time_transf=(t₀,T) -&gt; ((x) -&gt;  t₀ + (x-t₀) * (2-(x-t₀)/(T-t₀))))</code></pre><p>Define the imputation grid in <code>setup</code>. <code>dt</code> defines the granulatrity of the imputation grid and <code>time_transf</code> defines a time transformation to use for transforming equidistant grid.</p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc/setup.jl#L106-L113">source</a></section><h2><a class="nav-anchor" id="Prior-over-the-starting-point-1" href="#Prior-over-the-starting-point-1">Prior over the starting point</a></h2><p>There are two types of priors for the starting point, either a <code>delta hit</code> at some specified value, corresponding to a known starting point and a Gaussian prior</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.KnownStartingPt" href="#BridgeSDEInference.KnownStartingPt"><code>BridgeSDEInference.KnownStartingPt</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">KnownStartingPt{T} &lt;: StartingPtPrior</code></pre><p>Indicates that the starting point is known and stores its value in <code>y</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc_extras/starting_pt.jl#L15-L19">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.GsnStartingPt" href="#BridgeSDEInference.GsnStartingPt"><code>BridgeSDEInference.GsnStartingPt</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">GsnStartingPt{T,S} &lt;: StartingPtPrior</code></pre><p>Indicates that the starting point is equipped with a Gaussian prior with mean <code>μ</code> and covariance matrix <code>Σ</code>. It also stores the most recently sampled white noise <code>z</code> used to compute the starting point and a precision matrix <code>Λ</code>:=<code>Σ</code>⁻¹. <code>μ₀</code> and <code>Σ₀</code> are the mean and covariance of the white noise</p><pre><code class="language-none">GsnStartingPt(μ::T, Σ::S)</code></pre><p>Base constructor. It initialises the mean <code>μ</code> and covariance <code>Σ</code> parameters and <code>Λ</code> is set according to <code>Λ</code>:=<code>Σ</code>⁻¹</p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc_extras/starting_pt.jl#L25-L37">source</a></section><p>For instance, to set a known starting point it is enough to call:</p><pre><code class="language-julia">set_x0_prior!(model_setup, KnownStartingPt(x0))</code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.set_x0_prior!" href="#BridgeSDEInference.set_x0_prior!"><code>BridgeSDEInference.set_x0_prior!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">set_priors!(setup::DiffusionSetup, priors, x0_prior, x0_guess=nothing)</code></pre><p>Store the priors over parameters (in <code>priors</code>) and over the starting point (in <code>x0_prior</code>) into the object <code>setup</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc/setup.jl#L128-L133">source</a></section><h2><a class="nav-anchor" id="Auxiliary-parameters-1" href="#Auxiliary-parameters-1">Auxiliary parameters</a></h2><p>There are two auxiliary parameters that can be set by the user. The first one is a thinning factor for saving the paths that are sampled by the MCMC sampler. The second specifies an adaptation scheme for tuning Guided proposals [TODO change the latter].</p><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>set_auxiliary!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2><a class="nav-anchor" id="Initialisation-of-internal-containers-1" href="#Initialisation-of-internal-containers-1">Initialisation of internal containers</a></h2><p>Once all the setting functions above have been run (with the only exception <code>set_auxiliary!</code> being optional), i.e.</p><pre><code class="language-julia">setup = DiffusionSetup(...)
set_observations!(setup, ...)
set_imputation_grid(setup, ...)
set_x0_prior!(setup, ...)</code></pre><p>then the following function should be run</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BridgeSDEInference.initialise!" href="#BridgeSDEInference.initialise!"><code>BridgeSDEInference.initialise!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">initialise(::Type{K}, setup::DiffusionSetup; verbose=false)</code></pre><p>Initialise the internal containers of <code>setup</code>. Check if all the necessary data has been passed to <code>setup</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/mmider/BridgeSDEInference.jl/blob/388329f88941c2b625d4519fa1c7240f05da3dc5/src/mcmc/setup.jl#L335-L339">source</a></section><p>Once run, the model setup is complete.</p><footer><hr/><a class="previous" href="../generate_data/"><span class="direction">Previous</span><span class="title">Data generation</span></a><a class="next" href="../mcmc_setup/"><span class="direction">Next</span><span class="title">MCMC Setup</span></a></footer></article></body></html>
